<!doctype html><html lang=en><head><title>Finalizers</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An open source Identity Aware Proxy and an Access Control Decision service for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand text-white" href=../../../../../ style=font-weight:500;font-size:1.5rem>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu">
<span class=navbar-toggler-icon></span></button><div class="offcanvas offcanvas-end bg-dark" tabindex=-1 id=mainMenuContent data-bs-scroll=true aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h5 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h5><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../../../docs/welcome style=align-self:center>Docs</a></li><li class=nav-item style=display:flex><a class='nav-link text-white' href=../../../../../openapi/ style=align-self:center>API</a></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Get Started</a><ul class="dropdown-menu bg-dark" aria-labelledby="Get Started-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li></ul></li><li class="nav-item dropdown" style=display:flex><a class='nav-link dropdown-toggle text-white' href=# id="Integration Guides-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false style=align-self:center>Integration Guides</a><ul class="dropdown-menu bg-dark" aria-labelledby="Integration Guides-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../../../docs/guides/contour/>Contour Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/haproxy/>HAProxy Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/opa/>Integration with OPA</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto" style=align-self:center><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=v0.12.0-alpha current-page=/docs/configuration/rules/pipeline_mechanisms/finalizers/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
v0.12.0-alpha</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1" style=display:flex><a class="nav-link text-white" style=align-self:center href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></nav></header><nav class="navbar navbar-expand-lg bg-light" aria-label="Docs menu"><div class=container-xxl><div class="row container-fluid"><doc-search class="col-auto me-auto" index-file=/heimdall/v0.12.0-alpha/index.json path-prefix=/heimdall/v0.12.0-alpha><form id=docs-search tabindex=1 class="doks-search position-relative me-auto"><input id=search class="form-control search-bar" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=search-suggestions class="shadow bg-white rounded collapse search-results"></div></form></doc-search><button class="col-auto navbar-toggler" type=button data-bs-toggle=collapse data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-arrow-down-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.5 15a.5.5.0 00.5-.5V2.707l3.146 3.147a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 10.708.708L11 2.707V14.5a.5.5.0 00.5.5zm-7-14a.5.5.0 01.5.5v11.793l3.146-3.147a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 01.708-.708L4 13.293V1.5a.5.5.0 01.5-.5z"/></svg></button></div><div class="row d-md-none"><div class="col-2 collapse navbar-collapse" id=docsMenuContent><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=false>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/haproxy/>HAProxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=true>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class="collapse show"><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=true>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=true>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></div></div></div></nav><div class="container-xxl d-xxl-flex"><aside class="d-none d-md-block pe-4 pt-4 flex-xxl-shrink-0"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=false>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-63bf47d7b1e91548862e3da277e46e20a4b75401 aria-expanded=false>
Integration Guides</button><div id=section-63bf47d7b1e91548862e3da277e46e20a4b75401 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/guides/contour/>Contour Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/emissary/>Emissary Ingress Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/haproxy/>HAProxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/opa/>Integration with OPA</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=true>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class="collapse show"><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=true>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=true>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../../../docs/configuration/rules/pipeline_mechanisms/finalizers/>Finalizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></aside><main class="px-3 pt-4 flex-xxl-grow-0"><h1>Finalizers</h1><div><linkable-headline-area><div class=paragraph><p>Finalizers, as the name implies, finalize the execution of the pipeline and enrich the request with data such as subject information or authentication tokens required by the upstream service. The available options range from adding a simple header over a structured JWT in a specific header, to driving specific protocols, e.g. to obtain a token required by the upstream service.</p></div><div class=sect1><h2 id=_finalizer_types>Finalizer Types</h2><div class=sectionbody><div class=paragraph><p>The following sections describe the available finalizer types in more detail. Some of these may support or require additional configuration. The corresponding properties are annotated with <code>mandatory</code>, respectively <code>optional</code> to denote configuration requirement, as well as with <code>overridable</code>, <code>not overriddable</code> and <code>partially overridable</code> to indicate whether the property can be overridden in a rule pipeline.</p></div><div class=sect2><h3 id=_noop>Noop</h3><div class=paragraph><p>As the name implies, this finalizer does nothing. As finalizer are the last step in a rule pipeline and act on the available <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> information, the usage of this finalizer makes only sense in combination with the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/#_noop>Noop Authenticator</a>, e.g. if your API should be publicly available. This finalizer type also doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this finalizer, you have to set the <code>type</code> property to <code>noop</code>.</p></div><div class=exampleblock><div class=title>Example 1. Noop finalizer configuration</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>foo</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>noop</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_header>Header</h3><div class=paragraph><p>This finalizer enables transformation of a <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> into HTTP headers. It can also be used to map information from the original <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_request><code>Request</code></a> into headers expected by the upstream service.</p></div><div class=paragraph><p>To enable the usage of this finalizer, you have to set the <code>type</code> property to <code>header</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>headers</code></strong>: <em>string map</em> (mandatory, overridable)</p><div class=paragraph><p>Enables configuration of arbitrary headers with any values build from available subject and request information (See also <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>Templating</a>).</p></div></li></ul></div><div class=exampleblock><div class=title>Example 2. Header finalizer configuration</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>foo</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>header</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>headers</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>X-User-ID</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{{</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>quote</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>.Subject.ID</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>}}&#39;</span>
    <span style=color:#a6e22e>X-User-Email</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{{</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>quote</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>.Subject.Attributes[&#34;email&#34;]</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>}}&#39;</span>
    <span style=color:#a6e22e>Host</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{{</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>quote</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>.Request.Header(&#34;Host&#34;)</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>}}&#39;</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_cookie>Cookie</h3><div class=paragraph><p>This finalizer enables transformation of a <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> into cookies. It can also be used to map information from the original <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_request><code>Request</code></a> into cookies expected by the upstream service.</p></div><div class=paragraph><p>To enable the usage of this finalizer, you have to set the <code>type</code> property to <code>cookie</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>cookies</code></strong>: <em>string map</em> (mandatory, overridable)</p><div class=paragraph><p>Enables configuration of arbitrary cookies with any values build from available subject information (See also <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>Templating</a>).</p></div></li></ul></div><div class=exampleblock><div class=title>Example 3. Cookie finalizer configuration</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>foo</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>cookies</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>cookies</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>user_id_cookie</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{{</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>quote</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>.Subject.ID</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>}}&#39;</span>
    <span style=color:#a6e22e>user_email_cookie</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>&#39;</span><span style=color:#e6db74>{{</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>quote</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>.Subject.Attributes[&#34;email&#34;]</span><span style=color:#fff;background-color:#272822> </span><span style=color:#e6db74>}}&#39;</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_jwt>JWT</h3><div class=paragraph><p>This finalizer enables transformation of the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> object into a token in a <a href=https://www.rfc-editor.org/rfc/rfc7519>JWT</a> format, which is then made available to your upstream service in either the HTTP <code>Authorization</code> header with <code>Bearer</code> scheme set, or in a custom header. In addition to setting the JWT specific claims, it allows setting custom claims as well. Your upstream service can then verify the signature of the JWT by making use of heimdall’s JWKS endpoint to retrieve the required public keys/certificates from.</p></div><div class=paragraph><p>To enable the usage of this finalizer, you have to set the <code>type</code> property to <code>jwt</code>.</p></div><div class="admonitionblock note"><table><tbody><tr><td class=icon><i class="fa icon-note" title=Note></i></td><td class=content>The usage of this finalizer type requires a configured <a href=../../../../../docs/configuration/cryptographic_material/>Signer</a> as well. At least it is a must in production environments.</td></tr></tbody></table></div><div class=paragraph><p>Configuration using the <code>config</code> property is optional. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>claims</code></strong>: <em>string</em> (optional, overridable)</p><div class=paragraph><p>Your template with custom claims, you would like to add to the JWT (See also <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>Templating</a>).</p></div></li><li><p><strong><code>ttl</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>Defines how long the JWT should be valid. Defaults to 5 minutes. Heimdall sets the <code>iat</code> and the <code>nbf</code> claims to the current system time. The value of the <code>exp</code> claim is then influenced by the <code>ttl</code> property.</p></div></li><li><p><strong><code>header</code></strong>: <em>object</em> (optional, not overridable)</p><div class=paragraph><p>Defines the <code>name</code> and <code>scheme</code> to be used for the header. Defaults to <code>Authorization</code> with scheme <code>Bearer</code>. If defined, the <code>name</code> property must be set. If <code>scheme</code> is not defined, no scheme will be prepended to the resulting JWT.</p></div></li></ul></div><div class=paragraph><p>The generated JWT is always cached until 5 seconds before its expiration. The cache key is calculated from the entire configuration of the finalizer instance and the available information about the current subject.</p></div><div class=exampleblock><div class=title>Example 4. JWT finalizer configuration</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>jwt_finalizer</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>jwt</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>ttl</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>5m</span>
  <span style=color:#a6e22e>header</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>name</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>X-Token</span>
  <span style=color:#a6e22e>claims</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
    <span style=color:#e6db74>{</span>
      <span style=color:#e6db74>{{ $user_name := .Subject.Attributes.identity.user_name -}}</span>
      <span style=color:#e6db74>&#34;email&#34;: {{ quote .Subject.Attributes.identity.email }},</span>
      <span style=color:#e6db74>&#34;email_verified&#34;: {{ .Subject.Attributes.identity.email_verified }},</span>
      <span style=color:#e6db74>&#34;name&#34;: {{ if $user_name }}{{ quote $user_name }}{{ else }}{{ quote $email }}{{ end }}</span>
    <span style=color:#e6db74>}</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_oauth2_client_credentials>OAuth2 Client Credentials</h3><div class=paragraph><p>This finalizer drives the <a href=https://www.rfc-editor.org/rfc/rfc6749#section-4.4>OAuth2 Client Credentials Grant</a> flow to obtain a token, which should be used for communication with the upstream service. By default, as long as not otherwise configured (see the options below), the obtained token is made available to your upstream service in the HTTP <code>Authorization</code> header with <code>Bearer</code> scheme set. Unlike the other finalizers, it does not have access to any objects created by the rule execution pipeline.</p></div><div class=paragraph><p>To enable the usage of this finalizer, you have to set the <code>type</code> property to <code>oauth2_client_credentials</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>token_url</code></strong>: <em>string</em> (mandatory, not overridable)</p><div class=paragraph><p>The token endpoint of the authorization server.</p></div></li><li><p><strong><code>client_id</code></strong>: <em>string</em> (mandatory, not overridable)</p><div class=paragraph><p>The client identifier for heimdall.</p></div></li><li><p><strong><code>client_secret</code></strong>: <em>string</em> (mandatory, not overridable)</p><div class=paragraph><p>The client secret for heimdall.</p></div></li><li><p><strong><code>auth_method</code></strong>: <em>string</em> (optional, not overridable)</p><div class=paragraph><p>The authentication method to be used according to <a href=https://www.rfc-editor.org/rfc/rfc6749#section-2.3.1>RFC 6749, Client Password</a>. Can be one of</p></div><div class=ulist><ul><li><p><code>basic_auth</code> (default if <code>auth_method</code> is not set): With that authentication method, the <code>"application/x-www-form-urlencoded"</code> encoded values of <code>client_id</code> and <code>client_secret</code> are sent to the authorization server via the <code>Authorization</code> header using the <code>Basic</code> scheme.</p></li><li><p><code>request_body</code>: With that authentication method the <code>client_id</code> and <code>client_secret</code> are sent in the request body together with the other parameters (e.g. <code>scopes</code>) defined by the flow.</p><div class="admonitionblock warning"><table><tbody><tr><td class=icon><i class="fa icon-warning" title=Warning></i></td><td class=content>Usage of <code>request_body</code> authentication method is not recommended and should be avoided.</td></tr></tbody></table></div></li></ul></div></li><li><p><strong><code>scopes</code></strong>: <em>string array</em> (optional, overridable)</p><div class=paragraph><p>The scopes required for the access token.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>How long to cache the token received from the token endpoint. Defaults to the token expiration information from the token endpoint (the value of the <code>expires_in</code> field) if present. If the token expiration inforation is not present and <code>cache_ttl</code> is not configured, the received token is not cached. If the token expiration information is present in the response and <code>cache_ttl</code> is configured the shorter value is taken. If caching is enabled, the token is cached until 5 seconds before its expiration. To disable caching, set it to <code>0s</code>. The cache key calculation is based on the entire <code>oauth2_client_credentials</code> configuration without considering the <code>header</code> property.</p></div></li><li><p><strong><code>header</code></strong>: <em>object</em> (optional, overridable)</p><div class=paragraph><p>Defines the <code>name</code> and <code>scheme</code> to be used for the header. Defaults to <code>Authorization</code> with scheme <code>Bearer</code>. If defined, the <code>name</code> property must be set. If <code>scheme</code> is not defined, no scheme will be prepended to the resulting JWT.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 5. OAuth2 Client Credentials finalizer configuration</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>get_token</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>oauth2_client_credentials</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>cache_ttl</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>5m</span>
  <span style=color:#a6e22e>header</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>name</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>X-Token</span>
    <span style=color:#a6e22e>scheme</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>MyScheme</span>
  <span style=color:#a6e22e>token_url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>https://my-oauth-provider.com/token</span>
  <span style=color:#a6e22e>client_id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>my_client</span>
  <span style=color:#a6e22e>client_secret</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>VerySecret!</span>
  <span style=color:#a6e22e>auth_method</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>basic_auth</span>
  <span style=color:#a6e22e>scopes</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>foo</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#e6db74>bar</span></code></pre></div></div></div></div></div></div></div></linkable-headline-area></div><p class="text-end fst-italic fs-7">Last updated on <span class=fw-bold>Oct 13, 2023</span></p><div class="d-flex justify-content-between"><a href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/><div class="fs-6 mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>Contextualizers</div></a><a class=ms-auto href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/><div class="fs-6 mb-3">Error Handlers<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></div></a></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022-2023 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../../>Home</a></li><li class=mb-2><a href=../../../../../docs/welcome>Docs</a></li><li class=mb-2><a href=../../../../../openapi/>API</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../../docs/operations/install/>Install</a></li><li class=mb-2><a href=../../../../../docs/getting_started/>Getting Started</a></li><li class=mb-2><a href=../../../../../docs/guides/>Integration Guides</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://discord.gg/qQgg8xKuyb>Discord</a></li></ul></div></div></div></footer><script src=../../../../../js/main.js defer></script>
<script src=https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js></script></body></html>