<!doctype html><html lang=en><head><title>Authorizers</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Heimdall is an open source identity aware proxy (IAP) and access control decision service, designed for cloud native applications"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../../../favicon.ico></head><body><header class="navbar navbar-expand-md navbar-dark bg-dark sticky-top"><nav class="container-xxl flex-wrap flex-lg-nowrap" aria-label="Main navigation"><a class="navbar-brand text-white" href=../../../../../>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=offcanvas data-bs-target=#mainMenuContent aria-controls=mainMenuContent aria-expanded=false aria-label="Open main menu">
<span class=navbar-toggler-icon></span></button><div class="offcanvas offcanvas-end bg-dark" tabindex=-1 id=mainMenuContent data-bs-scroll=true aria-labelledby=mainMenuContentLabel><div class=offcanvas-header><h4 class="offcanvas-title text-white" id=mainMenuContentLabel>Heimdall</h4><button type=button class="btn-close btn-close-white" data-bs-dismiss=offcanvas aria-label="Close main menu"></button></div><div class=offcanvas-body><ul class="navbar-nav flex-column flex-md-row"><li class=nav-item><a class='nav-link text-white' href=../../../../../docs/welcome>Docs</a></li><li class=nav-item><a class='nav-link text-white' href=../../../../../openapi/>API</a></li><li class="nav-item dropdown"><a class='nav-link dropdown-toggle text-white' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false>Get Started</a><ul class="dropdown-menu bg-dark" aria-labelledby="Get Started-navbarDropdown"><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li><a class='dropdown-item text-white' href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li></ul></li></ul><hr class="text-white-50 d-md-none"><ul class="navbar-nav flex-column ms-auto"><doc-version-select class="nav-item dropdown" version-file=/heimdall/data.json current-version=v0.8.0-alpha current-page=/docs/configuration/rules/pipeline_mechanisms/authorizers/><button class="btn btn-dark dropdown-toggle me-4" data-bs-toggle=dropdown aria-expanded=false>
v0.8.0-alpha</button></doc-version-select></ul><ul class="navbar-nav flex-column"><li class="nav-item mb-1"><a class="nav-link text-white" href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg><small class="ms-2 d-md-none">GitHub</small></a></li></ul></div></div></nav></header><nav class="navbar navbar-expand-lg bg-light" aria-label="Docs menu"><div class=container-xxl><div class="row container-fluid"><doc-search class="col-auto me-auto" index-file=/heimdall/v0.8.0-alpha/index.json path-prefix=/heimdall/v0.8.0-alpha><form id=docs-search tabindex=1 class="doks-search position-relative me-auto"><input id=search class="form-control search-bar" type=search placeholder="Search docs..." aria-label="Search docs..." autocomplete=off><div id=search-suggestions class="shadow bg-white rounded collapse search-results"></div></form></doc-search><button class="col-auto navbar-toggler" type=button data-bs-toggle=collapse data-bs-target=#docsMenuContent aria-controls=docsMenuContent aria-expanded=false aria-label="Open docs menu"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-arrow-down-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.5 15a.5.5.0 00.5-.5V2.707l3.146 3.147a.5.5.0 00.708-.708l-4-4a.5.5.0 00-.708.0l-4 4a.5.5.0 10.708.708L11 2.707V14.5a.5.5.0 00.5.5zm-7-14a.5.5.0 01.5.5v11.793l3.146-3.147a.5.5.0 01.708.708l-4 4a.5.5.0 01-.708.0l-4-4a.5.5.0 01.708-.708L4 13.293V1.5a.5.5.0 01.5-.5z"/></svg></button></div><div class="row d-md-none"><div class="col-2 collapse navbar-collapse" id=docsMenuContent><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=false>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-929a28d261428029e61c0f81c6161fd71ba0b2fe aria-expanded=false>
Guides</button><div id=section-929a28d261428029e61c0f81c6161fd71ba0b2fe class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/opa/>Integration with OPA</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=true>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class="collapse show"><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=true>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=true>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/unifiers/>Unifiers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></div></div></div></nav><div class="container-xxl d-xxl-flex"><aside class="d-none d-md-block pe-4 pt-4 flex-xxl-shrink-0"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/welcome/>Welcome</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 aria-expanded=false>
Getting Started</button><div id=section-010b85ad56b34c34c7c2a3b2436c740e30428ed5 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/concepts/>Concepts</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/decision_service_quickstart/>Decision Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/proxy_service_quickstart/>Proxy Service Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/getting_started/configuration_introduction/>Configuration Introduction</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a aria-expanded=false>
Operations</button><div id=section-a1fdaa6b2a846c8fcf18d414bf8c61db610eda6a class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/operations/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/cli/>CLI</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/observability/>Observability</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/operations/security/>Security</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-929a28d261428029e61c0f81c6161fd71ba0b2fe aria-expanded=false>
Guides</button><div id=section-929a28d261428029e61c0f81c6161fd71ba0b2fe class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/guides/opa/>Integration with OPA</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 aria-expanded=true>
Configuration</button><div id=section-754164850f38c1ecdaf6b8ed894cb192bc36c5f4 class="collapse show"><ul class="nav flex-column"><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-5cbd584046863bc7b753e57e8681a98a87f36f0f aria-expanded=false>
Services</button><div id=section-5cbd584046863bc7b753e57e8681a98a87f36f0f class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/decision/>Decision</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/services/management/>Management</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-e2397377af6d698b0fb66f53c47349a85bd2cb00 aria-expanded=false>
Observability</button><div id=section-e2397377af6d698b0fb66f53c47349a85bd2cb00 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/observability/profiling/>Runtime Profiling</a></li></ul></div></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a aria-expanded=true>
Rules</button><div id=section-bb11a8e3f8712e36e7cd9d1c615a4e3dbb03336a class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/overview/>Rules Overview</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 aria-expanded=true>
Pipeline Mechanisms</button><div id=section-83ebcaaac1209f17a08fa17b9b1837aca7b222f7 class="collapse show"><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/>Mechanisms Overview</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a></li><li class=nav-item><a class="nav-link fw-bold" href=../../../../../docs/configuration/rules/pipeline_mechanisms/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/>Contextualizers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/unifiers/>Unifiers</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/pipeline_mechanisms/error_handlers/>Error Handlers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/configuration/>Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/default/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/rules/providers/>Rule Providers</a></li></ul></div></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/cryptographic_material/>Cryptographic Material</a></li><li class=nav-item><button class="btn btn-toggle align-items-center rounded collapsed fw-bold border-0" data-bs-toggle=collapse data-bs-target=#section-db1c784524e1b54011a95823026161f7c8517fe0 aria-expanded=false>
Reference</button><div id=section-db1c784524e1b54011a95823026161f7c8517fe0 class=collapse><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/types/>Configuration Types</a></li><li class=nav-item><a class=nav-link href=../../../../../docs/configuration/reference/reference/>Static Configuration Reference</a></li></ul></div></li></ul></div></li></ul></aside><main class="px-3 pt-4 flex-xxl-grow-0"><h1>Authorizers</h1><div><div class=paragraph><p>Authorizers ensure that the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> obtained via an authenticator has the required permissions to submit the given HTTP request and thus to execute the corresponding logic in the upstream service. E.g. a specific endpoint of the upstream service might only be accessible to a "user" from the "admin" group, or to an HTTP request if a specific HTTP header is set.</p></div><div class=sect1><h2 id=_authorizer_types>Authorizer Types</h2><div class=sectionbody><div class=paragraph><p>The following sections describe the available authorizer types in more detail. Some of these may support or require additional configuration. The corresponding properties are annotated with <code>mandatory</code>, respectively <code>optional</code> to denote configuration requirement, as well as with <code>overridable</code>, <code>not overriddable</code> and <code>partially overridable</code> to indicate whether the property can be overridden in a rule pipeline.</p></div><div class=sect2><h3 id=_allow>Allow</h3><div class=paragraph><p>As the name implies, this authorizer allows any request passing through. This authorizer type also doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>allow</code>.</p></div><div class=exampleblock><div class=title>Example 1. Configuration of Allow authorizer</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow_any_request</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_deny>Deny</h3><div class=paragraph><p>As the name implies, this authorizer denies any request (on HTTP response code level this is then mapped to <code>403 Forbidden</code>). It basically stops the successful execution of the pipeline resulting in the execution of the error handler mechanisms. This authorizer type doesn’t have any configuration options.</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>deny</code>.</p></div><div class=exampleblock><div class=title>Example 2. Configuration of Deny authorizer</div><div class=content><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>deny_any_request</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>deny</span></code></pre></div></div></div></div></div><div class=sect2><h3 id=_local_cel>Local (CEL)</h3><div class=paragraph><p>This authorizer allows definition of authorization requirements based on information available about the authenticated subject, as well as the actual request by using <a href=https://github.com/google/cel-spec>CEL</a> based authorization expressions. Each expression is expected to return <code>true</code> to signal success. Otherwise, the authorization fails, resulting in the execution of the error handler mechanisms.</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>cel</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>expressions</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_authorization_expression>Authorization Expression</a> array</em> (mandatory, overridable)</p><div class=paragraph><p>List of authorization expressions, which define the actual authorization logic. Each expression has access to the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> and the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_request><code>Request</code></a> objects.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 3. Authorization based on subject properties</div><div class=content><div class=paragraph><p>In this example the subject is checked to be member of the "admin" group.</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>user_is_admin</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>cel</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>expressions</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>expression</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
        <span style=color:#e6db74>has(Subject.Attributes.groups) &amp;&amp;</span>
        <span style=color:#e6db74>Subject.Attributes.groups.exists(g, g == &#34;admin&#34;)</span>
      <span style=color:#a6e22e>message</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>User is not admin</span></code></pre></div></div><div class=paragraph><p>The first line of the expressions verifies that the property group exists. The second line checks, whether <code>groups</code> contains an entry named <code>admin</code>.</p></div><div class=paragraph><p>This example specifies also a message, which is logged, if the expression fails.</p></div></div></div><div class=exampleblock><div class=title>Example 4. Authorization based on subject and request properties</div><div class=content><div class=paragraph><p>In this example the authorizer is configured to ensure anonymous access to a resource is possible for read requests only.</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>no_modification_allowed_by_anonymous</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>cel</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>expressions</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>expression</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
        <span style=color:#e6db74>Request.Method in [&#34;GET&#34;, &#34;HEAD&#34;, &#34;OPTIONS&#34;] || Subject.ID != &#34;anonymous&#34;</span>
      <span style=color:#a6e22e>message</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>Anonymous non-read access is forbidden</span></code></pre></div></div><div class=paragraph><p>The usage of this type of configuration makes sense in a pipeline, which combines multiple <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/>Authenticators</a>, allowing anonymous and authenticated access.</p></div></div></div></div><div class=sect2><h3 id=_remote>Remote</h3><div class=paragraph><p>This authorizer allows communication with other systems, like <a href=https://www.openpolicyagent.org/>Open Policy Agent</a>, <a href=https://www.ory.sh/docs/keto/>Ory Keto</a>, etc. for the actual authorization purpose. If the used endpoint answers with a not 2xx HTTP response code, this authorizer assumes, the authorization has failed, resulting in the execution of the error handler mechanisms. Otherwise, if no expressions for the verification of the response are defined, the authorizer assumes, the request has been authorized. If expressions are defined and do not fail, the authorization succeeds.</p></div><div class=paragraph><p>If your authorization system provides a payload in the response, heimdall inspects the <code>Content-Type</code> header to prepare the payload for further usage, e.g. for payload verification expressions, or for a <a href=#_local_cel>Local (CEL)</a> authorizer. If the content type does either end with <code>json</code> or is <code>application/x-www-form-urlencoded</code>, the payload is decoded, so key based access to the corresponding attributes is possible, otherwise it is made available as well, but as a simple string. In all cases this value is available for the authorization expressions as well as in the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject>Subject’s</a> <code>Attributes</code> property under a key named by the <code>id</code> of the authorizer (See also the example below).</p></div><div class=paragraph><p>To enable the usage of this authorizer, you have to set the <code>type</code> property to <code>remote</code>.</p></div><div class=paragraph><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p></div><div class=ulist><ul><li><p><strong><code>endpoint</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_endpoint>Endpoint</a></em> (mandatory, partially overridable)</p><div class=paragraph><p>The API endpoint of your authorization system. At least the <code>url</code> must be configured. This mechanism allows templating of the url and makes the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> object, as well as the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_values><code>Values</code></a> (see also below) objects available to it. By default, this authorizer will use HTTP <code>POST</code> to send the rendered payload to this endpoint. You can override this behavior by configuring <code>method</code> as well. Depending on the API requirements of your authorization system, you might need to configure further properties, like headers, etc.</p></div><div class=paragraph><p>The only overridable property on the rule level is the <code>values</code> property, which allows rule specific configuration of the URL.</p></div></li><li><p><strong><code>payload</code></strong>: <em>string</em> (optional, overridable)</p><div class=paragraph><p>Your <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_templating>template</a> with definitions required to communicate to the authorization endpoint. The template can make use of <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_subject><code>Subject</code></a> and <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_request><code>Request</code></a> objects.</p></div></li><li><p><strong><code>expressions</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_authorization_expression>Authorization Expression</a> array</em> (optional, overridable)</p><div class=paragraph><p>List of <a href=https://github.com/google/cel-spec>CEL</a> expressions which define the logic to be applied to the response returned by the endpoint. All expressions are expected to evaluate to <code>true</code> if the authorization was successful. If any of the expressions evaluates to <code>false</code>, the authorization fails and the message defined by the failed expression will be logged.</p></div><div class=paragraph><p>Each expression has access to the <a href=../../../../../docs/configuration/rules/pipeline_mechanisms/overview/#_payload><code>Payload</code></a> object.</p></div></li><li><p><strong><code>forward_response_headers_to_upstream</code></strong>: <em>string array</em> (optional, overridable)</p><div class=paragraph><p>Enables forwarding of any headers from the authorization endpoint response to the upstream service.</p></div></li><li><p><strong><code>cache_ttl</code></strong>: <em><a href=../../../../../docs/configuration/reference/types/#_duration>Duration</a></em> (optional, overridable)</p><div class=paragraph><p>Allows caching of the authorization endpoint responses. Defaults to 0s, which means no caching. The cache key is calculated from the entire configuration of the authorizer instance and the available information about the current subject.</p></div></li></ul></div><div class=exampleblock><div class=title>Example 5. Configuration of Remote authorizer to communicate with <a href=https://www.openpolicyagent.org/>Open Policy Agent</a> (OPA)</div><div class=content><div class=paragraph><p>Here the remote authorizer is configured to communicate with OPA. Since OPA expects the query to be formatted as JSON, the corresponding <code>Content-Type</code> header is set. Since the responses are JSON objects as well, the <code>Accept</code> header is also provided. In addition, this examples uses the <code>basic_auth</code> auth type to authenticate against the endpoint.</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>opa</span>
<span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>remote</span>
<span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#a6e22e>endpoint</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#a6e22e>url</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>https://opa.local/v1/data/{{ .Values.namespace }}/{{ .Values.policy }}</span>
    <span style=color:#a6e22e>headers</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#a6e22e>Content-Type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>json</span>
      <span style=color:#a6e22e>Accept</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>json</span>
    <span style=color:#a6e22e>auth</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#a6e22e>type</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>basic_auth</span>
      <span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span>
        <span style=color:#a6e22e>user</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>${OPA_USER}</span>
        <span style=color:#a6e22e>password</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>${OPA_PASSWORD}</span>
    <span style=color:#a6e22e>values</span><span style=color:#fff;background-color:#272822>:</span>
      <span style=color:#a6e22e>namespace</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>myapi/policy</span>
      <span style=color:#a6e22e>policy</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow_write</span>
  <span style=color:#a6e22e>payload</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
    <span style=color:#e6db74>{ &#34;input&#34;: { &#34;user&#34;: {{ quote .Subject.ID }} } }</span>
  <span style=color:#a6e22e>expressions</span><span style=color:#fff;background-color:#272822>:</span>
    <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>expression</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#fff;background-color:#272822>|</span>
        <span style=color:#e6db74>Payload.result == true</span>
      <span style=color:#a6e22e>message</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>User does not have required permissions</span></code></pre></div></div><div class=paragraph><p>In this case, since an OPA response could look like <code>{ "result": true }</code> or <code>{ "result": false }</code>, heimdall makes the response also available under <code>Subject.Attributes["opa"]</code> as a map, with <code>"opa"</code> being the id of the authorizer in this example.</p></div><div class=paragraph><p>A specific rule could then use this authorizer in the following ways:</p></div><div class=listingblock><div class=content><pre class="rouge highlight" style=color:#fff;background-color:#272822><code data-lang=yaml><span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>rule1</span>
  <span style=color:#75715e># other rule properties</span>
  <span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#75715e># other mechanisms</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authorizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>opa</span> <span style=color:#75715e># using defaults</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#75715e># other mechanisms</span>

<span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>id</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>rule2</span>
  <span style=color:#75715e># other rule properties</span>
  <span style=color:#a6e22e>execute</span><span style=color:#fff;background-color:#272822>:</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#75715e># other mechanisms</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#a6e22e>authorizer</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>opa</span>
    <span style=color:#a6e22e>config</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#75715e># overriding with rule specifics</span>
      <span style=color:#a6e22e>endpoint</span><span style=color:#fff;background-color:#272822>:</span>
        <span style=color:#a6e22e>values</span><span style=color:#fff;background-color:#272822>:</span>
          <span style=color:#a6e22e>policy</span><span style=color:#fff;background-color:#272822>:</span> <span style=color:#e6db74>allow_read</span>
  <span style=color:#fff;background-color:#272822>-</span> <span style=color:#75715e># other mechanisms</span></code></pre></div></div></div></div></div></div></div></div><p class="text-end fst-italic fs-7">Last updated on <span class=fw-bold>Apr 17, 2023</span></p><div class="d-flex justify-content-between"><a href=../../../../../docs/configuration/rules/pipeline_mechanisms/authenticators/><div class="fs-6 mb-3"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>Authenticators</div></a><a class=ms-auto href=../../../../../docs/configuration/rules/pipeline_mechanisms/contextualizers/><div class="fs-6 mb-3">Contextualizers<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></div></a></div></main></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../../>Home</a></li><li class=mb-2><a href=../../../../../docs/welcome>Docs</a></li><li class=mb-2><a href=../../../../../openapi/>API</a></li><li class=mb-2><a href=../../../../../docs/getting_started/concepts/>Get Started</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../../docs/operations/install/>Install</a></li><li class=mb-2><a href=../../../../../docs/guides/nginx/>NGINX Integration</a></li><li class=mb-2><a href=../../../../../docs/guides/traefik/>Traefik Proxy Integration</a></li><li class=mb-2><a href=../../../../../docs/guides/envoy/>Envoy Integration</a></li><li class=mb-2><a href=../../../../../docs/guides/opa/>Integration with OPA</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://github.com/dadrus/heimdall/issues>Issues</a></li><li class=mb-2><a href=https://github.com/dadrus/heimdall/discussions>Discussions</a></li></ul></div></div></div></footer><script src=../../../../../js/main.js defer></script>
<script src=https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js></script></body></html>