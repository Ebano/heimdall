<!doctype html><html><head><title>Authenticators</title><meta charset=utf-8><meta name=description content="Website meta description for google search results go here"><meta name=dc.relation content="https://dadrus.github.io/heimdall/"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../../heimdall/css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../../favicon.ico></head><body><nav class="navbar navbar-expand-lg navbar-light bg-dark fixed-top"><div class=container><a class="navbar-brand text-white" href=https://dadrus.github.io/heimdall/>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class=nav-item><a class='text-white nav-link' href=https://dadrus.github.io/heimdall/docs/introduction/architecture>Docs</a></li><li class=nav-item><a class='text-white nav-link' href=https://dadrus.github.io/heimdall/docs/api/>API</a></li><li class="nav-item dropdown"><a class='text-white nav-link dropdown-toggle' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false>Get Started</a><ul class=dropdown-menu aria-labelledby="Get Started-navbarDropdown"><li><a class=dropdown-item href=../../../../heimdall/docs/introduction/install/>Install</a></li><li><a class=dropdown-item href=../../../../heimdall/docs/introduction/quickstart/>Quickstart</a></li></ul></li></ul><a class=d-flex href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div></div></nav><div id=content class=container><div class=row><div class=col-3><ul class="nav flex-column"><li class=nav-item><span class=nav-link>Introduction</span><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/introduction/architecture/>Architecture</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/introduction/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/introduction/quickstart/>Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/introduction/from_source/>Install from Source</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/>Configuration</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/decision_api/>Decision API</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/proxy/>Proxy</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/tracing/>Tracing</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/>Pipeline</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/hydrators/>Hydrators</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/mutators/>Mutators</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/error_handlers/>Error Handlers</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/pipeline/configuration_types/>Configuration Types</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/rules/>Rules</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/rules/default/>Default</a></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/rules/providers/>Providers</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/configuration/reference/>Reference</a></li></ul></li><li class=nav-item><span class=nav-link>Guides</span><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../../heimdall/docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></li></ul></div><div class=col-9><h1>Authenticators</h1><div><p>Authenticators inspect HTTP requests, like the presence of a specific cookie, which represents the authentication object of the subject with the service and execute logic required to verify the authentication status and obtain information about that subject. A subject, could be a user who tries to use particular functionality of the upstream service, a machine (if you have machine-2-machine interaction), or something different. Authenticators ensure the subject has already been authenticated and the information available about it is valid.</p><h2 id=general-configuration>General Configuration</h2><p>Before being able to use authenticators in a rule, the required ones must be configured:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>pipeline</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>authenticators</span>:
</span></span><span style=display:flex><span>    <span style=color:#ae81ff>&lt;list of authenticators&gt;</span>
</span></span></code></pre></div><p>Each authenticator configuration entry must contain at least the following properties:</p><ul><li><code>id</code> - The unique identifier of an authenticator. Identifiers are used to reference the required authenticator from a rule. You can choose whatever identifier, you want. It is just a name. It must however be unique across all defined authenticators in the pipeline.</li><li><code>type</code> - The type of authenticator. This is used to select the required authenticator type. Available types are described in the next section.</li></ul><p>Depending on authenticator type, there can be an additional <code>config</code> property for, as the name implies the definition of authenticator&rsquo;s specific configuration. Every authenticator type can be defined as many times as needed in the pipeline definition. However, for those, which don&rsquo;t have a configuration, it doesn&rsquo;t really make sense, as all of them would behave the same way.</p><p>So your authenticator definitions could look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>pipeline</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>authenticators</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>foo</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bar</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>baz</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bla</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>bla</span>: <span style=color:#ae81ff>bar</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>zab</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bar</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>oof</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>bla</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>bar</span>: <span style=color:#ae81ff>bla</span>
</span></span></code></pre></div><p>The above pipeline configures two instances of an imaginary authenticator of type <code>bar</code> available via ids <code>foo</code> and <code>zab</code>, as well as two instances of an imaginary authenticator of type <code>bla</code> available via ids <code>baz</code> and <code>oof</code>. The <code>baz</code> and <code>oof</code> authenticators are different, as they are configured differently, but <code>foo</code> and <code>zab</code> authenticators do not have a configuration, so they behave the same way and there is actually no need to define two instances of them.</p><h2 id=authenticator-types>Authenticator Types</h2><h3 id=noop>Noop</h3><p>As the name implies, this authenticator does nothing. It tells Heimdall to bypass the authentication. This is the only one authenticator type, which does not create a subject object on a successful execution, which is required by the most other pipeline handlers. This authenticator type also doesn&rsquo;t have any configuration options.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>noop</code>.</p><p><strong>Example</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>foo</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>noop</span>
</span></span></code></pre></div><h3 id=unauthorized>Unauthorized</h3><p>This authenticator tells Heimdall to reject all requests as unauthorized. It basically stops the successful execution of the pipeline resulting in the execution of the error handlers. This authenticator type doesn&rsquo;t have any configuration options.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>unauthorized</code>.</p><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>foo</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>unauthorized</span>
</span></span></code></pre></div><h3 id=anonymous>Anonymous</h3><p>This authenticator just creates a subject object and sets its id to <code>anonymous</code> without doing anything else. You can overwrite the value of subject&rsquo;s id by using the optional <code>config</code> property.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>anonymous</code>.</p><p>Configuration using the <code>config</code> property is optional. Following properties are available:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>subject</code></td><td><em>string</em></td><td>Enables setting the id of the created subject object to a custom value.</td></tr></tbody></table><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>foo</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>anonymous</span>
</span></span><span style=display:flex><span><span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>subject</span>: <span style=color:#ae81ff>anon</span>
</span></span></code></pre></div><h3 id=basic-auth>Basic Auth</h3><p>This authenticator verifies the provided credentials according to the HTTP &ldquo;Basic&rdquo; authentication scheme, described in <a href=https://datatracker.ietf.org/doc/html/rfc7617>RFC 7617</a>. This authenticator does not challenge the authentication, it only verifies the provided credentials and sets the subject id to the configured value if the authentications succeeds. Otherwise, it raises an error, which results in the execution of the configured error handlers. The &ldquo;WWW Authenticate&rdquo; error handler can then for example be used if the corresponding challenge is required.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>basic_auth</code>.</p><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p><table><thead><tr><th>Name</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>user_id</code></td><td><em>string</em></td><td>The identifier of the subject to be verified (mandatory).</td></tr><tr><td><code>password</code></td><td><em>string</em></td><td>The password of the subject to be verified (mandatory).</td></tr></tbody></table><p><strong>Example:</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>foo</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>basic_auth</span>
</span></span><span style=display:flex><span><span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>user_id</span>: <span style=color:#ae81ff>bar</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>password</span>: <span style=color:#ae81ff>baz</span>
</span></span></code></pre></div><h3 id=generic>Generic</h3><p>This authenticator is kind of a swiss knife and can do a lot depending on the given configuration. It verifies the authentication status of the subject by making use of values available in the cookies, headers, or query parameters of the HTTP request and communicating with the actual authentication system to perform the actual verification on the one hand and to get the information about subject on the other hand. There is however one limitation: it can only deal with JSON responses.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>generic</code>.</p><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p><table><thead><tr><th>Name</th><th>Type</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td><code>identity_info_endpoint</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#endpoint>Endpoint</a></em></td><td>yes</td><td>The endpoint to communicate to for the actual subject authentication status verification purpose. At least the <code>url</code> must be configured. If you don&rsquo;t configure <code>method</code>, HTTP <code>POST</code> will be used. The <code>Accept</code> header is set to <code>application/json</code> by default. You can overwrite these setting however if required. Don&rsquo;t forget - this authenticator supports only JSON responses.</td></tr><tr><td><code>authentication_data_source</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#authentication-data-source>Authentication Data Source</a></em></td><td>yes</td><td>Where to extract the authentication data from the request. This authenticator will use the matched authentication data source as is while sending it to the <code>identity_info_endpoint</code>. If you configure to strip a prefix (if header is defined, this will most probably not work)</td></tr><tr><td><code>session</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#session>Session</a></em></td><td>yes</td><td>Where to extract the subject id from the identity info endpoint response, as well as which attributes to use.</td></tr><tr><td><code>cache_ttl</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#duration>Duration</a></em></td><td>no</td><td>How long to cache the response. If not set, response caching if disabled.</td></tr></tbody></table><p><strong>Example 1</strong></p><p>This example shows how to configure this authenticator to work with an authentication system, which issues a cookie upon successful user authentication to maintain the authentication state. To reduce the communication overhead, it also makes use of <code>cache_ttl</code> to cache the response for 5 minutes.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>session_cookie</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>generic</span>
</span></span><span style=display:flex><span><span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>identity_info_endpoint</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://my-auth.system/sessions/whoami</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>authentication_data_source</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>cookie</span>: <span style=color:#ae81ff>my_session</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>session</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>subject_id_from</span>: <span style=color:#e6db74>&#34;identity.id&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>cache_ttl</span>: <span style=color:#ae81ff>5m</span>
</span></span></code></pre></div><p><strong>Example 2</strong></p><p>This example shows how to configure this authenticator to work with an authentication system, which issues a Bearer token upon successful user authentication to maintain the authentication state. To reduce the communication overhead, it also makes use of <code>cache_ttl</code> to cache the response for 5 minutes. In this example we configure the handler to use the <code>GET</code> method instead of the default <code>POST</code> for sending the bearer token to the authentication system for verification purposes and also to authenticate using HTTP basic auth schema. According to the below configuration, the Bearer token is located in the <code>X-Custom-Bearer-Token</code> header, which as also used as is while calling the <code>http://my-auth.system/introspect</code> endpoint.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>bearer_token</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>generic</span>
</span></span><span style=display:flex><span><span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>identity_info_endpoint</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://my-auth.system/introspect</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>method</span>: <span style=color:#ae81ff>GET</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>auth</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>basic_auth</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>user</span>: <span style=color:#ae81ff>Heimdall</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>password</span>: <span style=color:#ae81ff>super-secure</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>authentication_data_source</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>header</span>: <span style=color:#ae81ff>X-Custom-Bearer-Token</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>session</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>subject_id_from</span>: <span style=color:#e6db74>&#34;sub&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>cache_ttl</span>: <span style=color:#ae81ff>5m</span>
</span></span></code></pre></div><p>Usually, Bearer tokens are issued by an OAuth2 auth provider and there is a need to verify not only the validity of such, but also a couple of claims. This can be achieved by a &ldquo;Local Authorizer&rdquo;, but there is also a special purpose <a href=#oauth2-introspection>OAuth2 Introspection</a> authenticator type, which supports asserting all security relevant claims in just one place.</p><h3 id=oauth2-introspection>OAuth2 Introspection</h3><p>This authenticator handles requests that have Bearer token in e.g. the HTTP Authorization header (<code>Authorization: Bearer &lt;token></code>), in a different header or a query parameter. It then uses <a href=https://datatracker.ietf.org/doc/html/rfc7662>OAuth 2.0 Token Introspection</a> endpoint to check if the token is valid. The validation includes at least the verification of the status and the time validity. That is if the token is still active and whether it has been issued in an acceptable time frame. Latter can be adjusted by specifying a leeway. All other validation options can and should be configured.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>oauth2_introspection</code>.</p><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p><table><thead><tr><th>Name</th><th>Type</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td><code>introspection_endpoint</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#endpoint>Endpoint</a></em></td><td>yes</td><td>The introspection endpoint of the OAuth2 authorization provider. At least the <code>url</code> must be configured. There is no need to define the <code>method</code> property or setting the <code>Content-Type</code> or the <code>Accept</code> header. These are set by default to the values required by the <a href=https://datatracker.ietf.org/doc/html/rfc7662>OAuth 2.0 Token Introspection</a> RFC. You can however overwrite these.</td></tr><tr><td><code>assertions</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#assertions>Assertions</a></em></td><td>yes</td><td>Configures the required claim assertions.</td></tr><tr><td><code>session</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#session>Session</a></em></td><td>no</td><td>Where to extract the subject id from the introspection endpoint response, as well as which attributes to use. If not configured <code>sub</code> is used to extract the subject id and all attributes from the introspection endpoint response are made available as attributes of the subject.</td></tr><tr><td><code>cache_ttl</code></td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#duration>Duration</a></em></td><td>no</td><td>How long to cache the response. If not set, caching of the introspection response is based on the available token expiration information. To disable caching, set it to <code>0s</code>. If you set the ttl to a custom value > 0, the expiration time (if available) of the token will be considered.</td></tr></tbody></table><p><strong>Example</strong></p><p>Here a minimal possible configuration</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>at_opaque</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>oauth2_introspection</span>
</span></span><span style=display:flex><span><span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>introspection_endpoint</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://hydra:4445/oauth2/introspect</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>assertions</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>issuers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>http://127.0.0.1:4444/</span>
</span></span></code></pre></div><h3 id=jwt>JWT</h3><p>As the <a href=#oauth2-introspection>OAuth2 Introspection</a> authenticator, this authenticator handles requests that have a Bearer Token in the <code>Authorization</code> header, in a different header or a query parameter as well. Unlike the OAuth2 Introspection authenticator it expects the token to be a JSON Web Token (JWT) and verifies it according <a href=https://www.rfc-editor.org/rfc/rfc7519#section-7.2>RFC 7519, Section 7.2</a>. It does however not support encrypted payloads and nested JWTs. In addition to this, validation includes the verification of the time validity. Latter can be adjusted by specifying a leeway. All other validation options can and should be configured.</p><p>To enable the usage of this authenticator, you have to set the <code>type</code> property to <code>jwt</code>.</p><p>Configuration using the <code>config</code> property is mandatory. Following properties are available:</p><table><thead><tr><th>Name</th><th>Type</th><th>Mandatory</th><th>Description</th></tr></thead><tbody><tr><td>jwks_endpoint</td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#endpoint>Endpoint</a></em></td><td>yes</td><td>The JWKS endpoint, this authenticator retrieves the key material in a format specified in <a href=https://datatracker.ietf.org/doc/html/rfc7519>RFC 7519</a> from for JWT signature verification purposes. The <code>url</code> must be configured. By default <code>method</code> is set to <code>GET</code> and the HTTP <code>Accept</code> header to <code>application/json</code></td></tr><tr><td>jwt_from</td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#authentication-data-source>Authentication Data Source</a></em></td><td>no</td><td>Where to get the access token from. If not set, this authenticator tries to retrieve it from the <code>Authorization</code> header and the <code>access_token</code> query paramter.</td></tr><tr><td>assertions</td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#assertions>Assertions</a></em></td><td>yes</td><td>Configures the required claim assertions.</td></tr><tr><td>session</td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#session>Session</a></em></td><td>no</td><td>Where to extract the subject id from the JWT, as well as which attributes to use. If not configured <code>sub</code> is used to extract the subject id and all attributes from the JWT payload are made available as attributes of the subject.</td></tr><tr><td>cache_ttl</td><td><em><a href=https://dadrus.github.io/heimdall/docs/configuration/pipeline/configuration_types/#duration>Duration</a></em></td><td>no</td><td>How long to cache the key from the JWKS response, which was used for signature verification purposes. If not set, Heimdall will cache this key for 10 minutes and not call JWKS endpoint again if the same <code>kid</code> is referenced in an JWT and same JWKS endpoint is used.</td></tr></tbody></table><p><strong>Example</strong></p><p>Here a minimal possible configuration</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>id</span>: <span style=color:#ae81ff>at_jwt</span>
</span></span><span style=display:flex><span><span style=color:#f92672>type</span>: <span style=color:#ae81ff>jwt</span>
</span></span><span style=display:flex><span><span style=color:#f92672>config</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>jwks_endpoint</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://hydra:4444/.well-known/jwks.json</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>assertions</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>issuers</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>http://127.0.0.1:4444/</span>
</span></span></code></pre></div></div></div></div></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../>Home</a></li><li class=mb-2><a href=../../../../>Docs</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../../>Install</a></li><li class=mb-2><a href=../../../../>Getting Started</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://github.com/dadrus/heimdall/issues>Issues</a></li><li class=mb-2><a href=https://github.com/dadrus/heimdall/discussions>Discussions</a></li></ul></div></div></div><script src=../../../../heimdall/js/bundle.min.js defer></script></footer></body></html>