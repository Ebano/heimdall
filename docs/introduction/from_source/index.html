<!doctype html><html><head><title>Install from Source</title><meta charset=utf-8><meta name=description content="Website meta description for google search results go here"><meta name=dc.relation content="https://dadrus.github.io/"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=theme-color content="#1A94D2"><link rel=stylesheet href=../../../css/styles.min.css media=screen><link rel='shortcut icon' type=image/x-icon href=../../../favicon.ico></head><body><nav class="navbar navbar-expand-lg navbar-light bg-dark fixed-top"><div class=container><a class="navbar-brand text-white" href=../../../>Heimdall</a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarSupportedContent aria-controls=navbarSupportedContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarSupportedContent><ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class=nav-item><a class='text-white nav-link' href=../../../docs/introduction/architecture>Docs</a></li><li class=nav-item><a class='text-white nav-link' href=../../../docs/api/>API</a></li><li class="nav-item dropdown"><a class='text-white nav-link dropdown-toggle' href=# id="Get Started-navbarDropdown" role=button data-bs-toggle=dropdown aria-expanded=false>Get Started</a><ul class=dropdown-menu aria-labelledby="Get Started-navbarDropdown"><li><a class=dropdown-item href=../../../docs/introduction/install/>Install</a></li><li><a class=dropdown-item href=../../../docs/introduction/quickstart/>Quickstart</a></li></ul></li></ul><a class=d-flex href=https://github.com/dadrus/heimdall><svg xmlns="http://www.w3.org/2000/svg" role="img" width="20" height="20" fill="currentcolor" class="bi bi-github text-white" viewBox="0 0 16 16"><title>GitHub</title><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div></div></nav><div id=content class=container><div class=row><div class=col-3><ul class="nav flex-column"><li class=nav-item><span class=nav-link>Introduction</span><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/introduction/architecture/>Architecture</a></li><li class=nav-item><a class=nav-link href=../../../docs/introduction/install/>Install</a></li><li class=nav-item><a class=nav-link href=../../../docs/introduction/quickstart/>Quickstart</a></li><li class=nav-item><a class=nav-link href=../../../docs/introduction/from_source/>Install from Source</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/>Configuration</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/>Services</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/decision_api/>Decision API</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/services/proxy/>Proxy</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/>Observability</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/logging/>Logging</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/metrics/>Metrics</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/observability/tracing/>Tracing</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/>Pipeline Handler</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/authenticators/>Authenticators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/authorizers/>Authorizers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/hydrators/>Hydrators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/mutators/>Mutators</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/error_handlers/>Error Handlers</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/pipeline/configuration_types/>Configuration Types</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/>Rules</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/default_rule/>Default Rule</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/rule_definition/>Rule Definition</a></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/rules/providers/>Providers</a></li></ul></li><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/>Reference</a><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/configuration/reference/configuration/>Static Configuration</a></li></ul></li></ul></li><li class=nav-item><span class=nav-link>Guides</span><ul class="nav flex-column"><li class=nav-item><a class=nav-link href=../../../docs/guides/traefik/>Traefik Proxy Integration</a></li></ul></li></ul></div><div class=col-9><h1>Install from Source</h1><div><p>This document covers how to build heimdall from its source code as well as how to run heimdall using a minimum configuration. If you want to try out a working scenario, head over to <a href=../../../docs/introduction/quickstart/>Quick Start</a>.</p><h2 id=prerequisites>Prerequisites</h2><ul><li><a href=https://git-scm.com/>git</a></li><li>The <a href=https://go.dev/dl/>Go</a> programming language >= 1.18.1</li><li><a href=https://docs.docker.com/install/>Docker</a> if you want to build a docker container (you don&rsquo;t need Golang then)</li></ul><h2 id=download>Download</h2><p>Retrieve the latest copy of heimdall source code by cloning the git repository</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone git@github.com:dadrus/heimdall.git
</span></span></code></pre></div><h2 id=build-with-go>Build with go</h2><p>Build using a single line with <code>go build</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go build -trimpath -ldflags<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;-buildid= -w -s -X heimdall/cmd.Version=my-custom-build&#34;</span>
</span></span></code></pre></div><p>The flags are set by intention. Using <code>-trimpath</code> and <code>-buildid=</code> as part of the <code>-ldflags</code> argument ensures the build is reproducible (See also <a href=https://reproducible-builds.org/>Reproducible Builds</a>). Other flags remove unused symbols and debug information.</p><h2 id=build-with-docker>Build with Docker</h2><p>The Docker build uses exactly the same <code>go build</code> command from above, compresses the binary and ensures the resulting docker image is secure.</p><pre tabindex=0><code class=language-bach data-lang=bach>$ docker build -t heimdal:local ./docker/Dockerfile .
</code></pre><p>The Dockerfile builds the heimdall image for linux with amd64 architecture.</p><h2 id=configure>Configure</h2><p>heimdall can be configured via environment variables, as well as using a configuration file. For simplicity reasons, we&rsquo;ll use a configuration file here. So create a config file (<code>config.yaml</code>) with the following content:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>pipeline</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>authenticators</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>anonymous_authenticator</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>anonymous</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>mutators</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>id</span>: <span style=color:#ae81ff>create_jwt</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>type</span>: <span style=color:#ae81ff>jwt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>default</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>methods</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>GET</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>POST</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>execute</span>:
</span></span><span style=display:flex><span>      - <span style=color:#f92672>authenticator</span>: <span style=color:#ae81ff>anonymous_authenticator</span>
</span></span><span style=display:flex><span>      - <span style=color:#f92672>mutator</span>: <span style=color:#ae81ff>create_jwt</span>
</span></span></code></pre></div><p>This configuration will create a JSON Web Token (JWT) with <code>sub</code> claim set to <code>anonymous</code> for every request on every URL for the HTTP methods GET and POST. The JWT itself will be put into the <code>Authorization</code> header as a bearer token.</p><h2 id=run>Run</h2><p>Finally, run heimdall specifying the configuration file from above</p><p>If you&rsquo;ve built heimdall using <code>go build</code>, just execute</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./heimdall serve api -c config.yaml
</span></span></code></pre></div><p>The above command will start heimdall in a decision api mode. By default, the service will be served on port <code>4456</code>.</p><p>Otherwise, if you&rsquo;ve built a Docker image, run heimdall in the decision api mode it via</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker run -t -v $PWD:/heimdall/conf -p 4456:4456 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  heimdal:local serve api -c /heimdall/conf/config.yaml
</span></span></code></pre></div><p>In both cases, you&rsquo;ll see similar output to</p><pre tabindex=0><code>8:16PM WRN Could not initialize opentracing tracer. Tracing will be disabled. error=&#34;no 
supported/configured opentracing provider&#34;
8:16PM INF Loading pipeline definitions
8:16PM ERR Failed to load rule definitions provider: file_system error=&#34;invalid provider 
configuration&#34;
8:16PM WRN Key store is not configured. NEVER DO IT IN PRODUCTION!!!! Generating an RSA 
key pair.
8:16PM WRN No key id for signer configured. Taking first entry from the key store
8:16PM INF Starting cache evictor
8:16PM INF Starting rule definition loader
8:16PM INF Prometheus endpoint starts listening on: :9000
8:16PM INF Decision API endpoint starts listening on: :4456
</code></pre><p>Ignore the error. It is expected as we&rsquo;ve not configured any rule set. Nevertheless, the default rule can be used.</p><h2 id=use>Use</h2><p>Sent some request to heimdall&rsquo;s decision endpoint:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -v 127.0.0.1:4456/decisions/foobar
</span></span></code></pre></div><p>Here, we&rsquo;re asking to apply the default rule for the <code>foobar</code> path using the <code>GET</code> HTTP verb.</p><p>On completion, you should see the <code>Authorization</code> header in the response, like in the output below:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>*   Trying 127.0.0.1:4456...
</span></span><span style=display:flex><span>* Connected to 127.0.0.1 <span style=color:#f92672>(</span>127.0.0.1<span style=color:#f92672>)</span> port <span style=color:#ae81ff>4456</span> <span style=color:#f92672>(</span><span style=color:#75715e>#0)</span>
</span></span><span style=display:flex><span>&gt; GET /decisions/foobar HTTP/1.1
</span></span><span style=display:flex><span>&gt; Host: 127.0.0.1:4456
</span></span><span style=display:flex><span>&gt; User-Agent: curl/7.74.0
</span></span><span style=display:flex><span>&gt; Accept: */*
</span></span><span style=display:flex><span>&gt; 
</span></span><span style=display:flex><span>* Mark bundle as not supporting multiuse
</span></span><span style=display:flex><span>&lt; HTTP/1.1 <span style=color:#ae81ff>200</span> OK
</span></span><span style=display:flex><span>&lt; Server: Heimdall Decision API
</span></span><span style=display:flex><span>&lt; Date: Wed, <span style=color:#ae81ff>27</span> Apr <span style=color:#ae81ff>2022</span> 18:16:19 GMT
</span></span><span style=display:flex><span>&lt; Content-Type: text/plain; charset<span style=color:#f92672>=</span>utf-8
</span></span><span style=display:flex><span>&lt; Content-Length: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>&lt; Authorization: Bearer eyJhbGciOiJQUzI1NiIsImtpZCI6ImU5NmZmYmMyLTlkMGItNmU3Ni0wZGE1LWVhMGNhZmNjMz
</span></span><span style=display:flex><span>BhOSIsInR5cCI6IkpXVCJ9.eyJleHAiOjE2NTEwODQyNzksImlhdCI6MTY1MTA4MzM3OSwiaXNzIjoiaGVpbWRhbGwiLCJqdGk
</span></span><span style=display:flex><span>iOiJkN2I5OGIzMy05NWIyLTRmMjgtOWE3NS1mZmUxMzJlMzYzYTciLCJuYmYiOjE2NTEwODMzNzksInN1YiI6ImFub255bW91c
</span></span><span style=display:flex><span>yJ9.merxkl1pcexeFS73tGWUfmOJoyIK1390gnaaiJ3ajtHVsvnvuo9xYPlAQvRnEdeXN-J439nI426Cin9KZF8JJYETgG7KtU
</span></span><span style=display:flex><span>qo_n5dkLrsokdi-STv609QQ-2rVmqjSnf9kd7e0ww5Qh0p-WSEbKkLng-sVmBUQ3Dg-qyAJ9YA5f_qgCPRuO5tgRVPRX-NHwKy
</span></span><span style=display:flex><span>cA28BnKwmHUPOmjuwBD7PeL3m_yOQEJgWhjGeIY_zkYE6F637JVS9QdesM-fOoPXeDXziOHtzMzy6QclhwofQn4FjgkF7FGIbH
</span></span><span style=display:flex><span>BamFj_xtTMUonvqjPXu8KYp39GXXnpIlEv2jdQ5u2C0gmuIpsBIw
</span></span><span style=display:flex><span>&lt; 
</span></span><span style=display:flex><span>* Connection <span style=color:#75715e>#0 to host 127.0.0.1 left intact</span>
</span></span></code></pre></div></div><p class="fs-6 fw-light fst-italic text-secondary text-end">Last updated on <time class=fw-bold>06/20/2022</time> by Dimitrij Drus</p></div></div></div><footer class="footer py-4 py-md-5 px-4 px-md-3"><div class=container><div class=row><div class="col-lg-3 mb-3"><p class=fs-5>Heimdall</p><ul class="list-unstyled small text-muted"><li class=mb-2>2022 © Heimdall Project Authors. All rights reserved.</li><li class=mb-2><a href=https://github.com/dadrus/heimdall/blob/master/LICENSE>Apache 2.0 licensed</a></li></ul></div><div class="col-6 col-lg-2 offset-lg-1 mb-3"><h5>Links</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Home</a></li><li class=mb-2><a href=../../../>Docs</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Guides</h5><ul class=list-unstyled><li class=mb-2><a href=../../../>Install</a></li><li class=mb-2><a href=../../../>Getting Started</a></li></ul></div><div class="col-6 col-lg-2 mb-2"><h5>Community</h5><ul class=list-unstyled><li class=mb-2><a href=https://github.com/dadrus/heimdall>Github</a></li><li class=mb-2><a href=https://github.com/dadrus/heimdall/issues>Issues</a></li><li class=mb-2><a href=https://github.com/dadrus/heimdall/discussions>Discussions</a></li></ul></div></div></div><script src=../../../js/bundle.min.js defer></script></footer></body></html>